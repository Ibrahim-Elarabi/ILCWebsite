@model ILC.BL.Models.Admin.HomeSection.Product.ProductHomeVM
@{
    Layout = "_Layout";
}
<!-- Start page content -->
<section id="page-content" class="page-wrapper">

    <!-- PROPERTIES DETAILS AREA START -->
    <div class="properties-details-area pt-115 pb-60">
        <div class="container">
            <div class="row">
                <h3 style="padding-left:18px" class="en">@Model?.TitleEn</h3>
                <h3 style="padding-left:18px" class="ar">@Model?.TitleAr</h3>
                <div class="col-md-4">
                    <div class="pro-details-image mb-60">
                        <div class="pro-details-big-image">
                            <div class="tab-content">
                                @foreach (var image in Model?.Images)
                                {
                                    <div role="tabpanel" class="tab-pane fade @(image == Model?.Images.FirstOrDefault() ? "in active" : "")" id="pro-@(image.Id)">
                                        <a href="@image.ImagePath" data-lightbox="image-@(image.Id)" data-title="@Model?.TitleEn">
                                            <img src="@image.ImagePath" alt="">
                                        </a>
                                    </div>
                                }
                            </div>
                        </div>
                        <div class="pro-details-carousel">
                            @foreach (var image in Model?.Images)
                            {
                                <div class="pro-details-item">
                                    <a href="#pro-@(image.Id)" data-toggle="tab">
                                        <img src="@image.ImagePath" alt="">
                                    </a>
                                </div>
                            }
                        </div>
                    </div>

                    <hr />
                    <div class="text-right">
                        <button id="openModalBtn" class="btn btn-primary">Send Inquiry</button>
                    </div>
                    <hr />
                    Similar Products

                    <div class="featured-flat-area pt-115 pb-60">
                        <div class="container">
                            <div class="featured-flat">
                                <div class="row">
                                    @foreach (var item in Model?.SimilarProducts)
                                    {
                                        <div class="col-md-2 col-sm-4 col-xs-12">
                                            <div class="flat-item">
                                                <div class="flat-item-image">
                                                    <a asp-controller="Product" asp-action="Details" asp-route-id="@item.Id"><img src="@item.ImagePath" alt=""></a>
                                                    <div class="flat-link">
                                                        <a asp-controller="Product" asp-action="Details" asp-route-id="@item.Id" data-i18n="more-details"></a>
                                                    </div>
                                                    <ul class="flat-desc">
                                                        <li>
                                                            <h5 style="color:white" class="en">@item.TitleEn</h5>
                                                            <h5 style="color:white" class="ar">@item.TitleAr</h5>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    }
                                </div>
                            </div>
                        </div>
                    </div>
                    @*  <a href="#">
                        <img src="@item?.ImagePath" alt="">
                    </a>  *@      


                    <div id="myModal" class="modal fade" tabindex="-1" role="dialog">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title">Send Inquiry</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <div>
                                        <h2>Modal Content</h2>
                                        <p>This is the content you want to display in the modal.</p>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="col-md-8">
                    <!-- pro-details-description -->
                    <h3 data-i18n="AboutProduct"></h3>
                    <div class="pro-details-description mb-50">
                        <p class="en">@Model?.DescriptionEn</p>
                        <p class="ar">@Model?.DescriptionAr</p>
                    </div>
                    <!-- pro-details-short-info -->
                    <div class="pro-details-short-info mb-60">
                        <div class="row">
                            <div class="col-sm-12 col-xs-12">
                                <div class="pro-details-amenities">
                                    <h3 data-i18n="Properties"></h3>
                                    <div class="pro-details-amenities-inner bg-gray">
                                        <ul class="amenities-list">
                                            @foreach (var item in Model?.Specifications)
                                            {
                                                <li>
                                                    <span style="font-weight:bold" class="en">@item?.TitleEn : </span>
                                                    <span style="font-weight:bold" class="ar">@item?.TitleAr : </span>
                                                    <p style="display:inline" class="en">
                                                        @item?.DescriptionEn
                                                    </p>
                                                    <p style="display:inline" class="ar">
                                                        @item?.DescriptionAr
                                                    </p>
                                                </li>
                                            }
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <!-- PROPERTIES DETAILS AREA END -->

</section>
<!-- End page content -->




@section Scripts{  
    <script src="~/js/npm_axios_dist_axios.min.js"></script>
    <partial name="_ValidationScriptsPartial" />
    <script src="~/customscript/shared.js"></script>
    <script>


        $(document).ready(function () { 
            $('#openModalBtn').click(function () {
                $.ajax({
                    url: '@Url.Action("Create", "Inquiry")',
                    type: 'GET',
                    success: function (data) {
                        $('#myModal .modal-body').html(data);
                        $('#myModal').modal('show');
                        getCountries();
                    },
                    error: function () {
                        console.log('Error occurred while fetching data.');
                    }
                });
            }); 
        });



        function getCountries() {
            axios.get('/Admin/Common/GetCountries')
                .then(response => {
                    document.getElementById('CountryId').innerHTML = '<option value="">-select-</option>';
                    response.data.forEach(country => {
                        const option = document.createElement('option');
                        option.value = country.id;
                        option.textContent = country.name;
                        document.getElementById('CountryId').appendChild(option);
                    });

                    // Add event listener to country dropdown
                    document.getElementById('CountryId').addEventListener('change', function () {
                        const selectedCountryId = this.value;
                        getCities(selectedCountryId);
                    });
                })
                .catch(error => {
                    console.error('Error occurred while fetching countries.', error);
                });
        }



        function getCities(countryId) {
            axios.get(`/Admin/Common/GetCities?countryId=${countryId}`)
                .then(response => {
                    document.getElementById('CityId').innerHTML = '<option value="">-select-</option>';
                    response.data.forEach(city => {
                        const option = document.createElement('option');
                        option.value = city.id;
                        option.textContent = city.name;
                        document.getElementById('CityId').appendChild(option);
                    });
                })
                .catch(error => {
                    console.error('Error occurred while fetching cities.', error);
                });
        }
        function CreateInquiry(e) { 
            if (e) {
                e.preventDefault();
                e.returnValue = false;
            }
            var form = $('#CreateInquiryForm').serialize(); 
            axios.post('/Inquiry/Create', form)
                .then(res => {
                    console.log(res);
                    $("#divLoader").hide();
                    if (res && res.data && res.data.success) {
                        if (res.data.success) {
                            swal.fire({
                                icon: "success",
                                title: "Success",
                                text: res.data.message,
                            }).then(function () {
                                window.location.reload();
                            });
                        }
                        else {
                            swal.fire({
                                icon: "warning",
                                title: "Failed",
                                text: res.data.message
                            });
                        }
                    }
                })
                .catch(error => {
                    console.error('An error occurred:', error);
                });
        } 
    </script>
}
